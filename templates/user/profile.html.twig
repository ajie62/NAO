{% extends 'base.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/stylesProfile.css') }}">
{% endblock %}

{% block title %}Mon profil{% endblock %}

{% block body %}
    <div class="profile-container beige-bg common-min-height common-centering">

        {# Profile header #}
        <div class="profile-header text-center">
            {% set role = user.roles[0] %}
            {% set particulier = role == 'ROLE_PARTICULIER' %}
            {% set naturaliste = role == 'ROLE_NATURALISTE' %}
            {% set admin = role == 'ROLE_ADMIN' %}
            <h2>{{ user.firstname ~ ' ' ~ user.lastname }}</h2>
            {% if user.image %}
                <img src="{{ user.image.webPath | imagine_filter('profile_picture') }}" alt="{{ user.image.alt }}">
            {% else %}
                <img src="{{ asset('images/no-profile.png') }}" alt="pas d'image de profil.">
            {% endif %}
                <p>{{ user.mail }}</p>
            <p>
                {% if naturaliste %}Naturaliste{% elseif admin %}Administrateur{% else %}Particulier{% endif %}
            </p>
        </div>

        {# User description #}
        <div class="profile-intro">
            <h3>Présentation</h3>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ab animi consequatur cumque
            deserunt eligendi enim eveniet, harum itaque iure libero magnam obcaecati officia
            perspiciatis repellendus sequi temporibus totam veritatis vero vitae voluptatum.
            Adipisci, consequatur eligendi ipsam rem velit voluptate. Adipisci amet corporis
            debitis deserunt doloremque maxime molestiae molestias, nostrum provident quo quos sint,
            veritatis? Accusantium animi, aut autem consequatur cum dicta distinctio earum est
            eveniet exercitationem expedita iusto nam nihil provident, quis ratione rem repellendus
            suscipit ullam vitae. Adipisci cupiditate explicabo id illo ipsum nihil non praesentium
            quaerat similique.

            <div class="text-right">
                <a href="#" class="txt-orange">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Modifier
                </a>
            </div>
        </div>

        {# Articles & observations #}
        <div class="profile-stats">
            {% if naturaliste or admin %}
                <h3>Mes articles</h3>
                <div class="profile-articles text-center txt-white">
                    <a href="{{ path('user.profile_draft_article') }}">
                        <div class="orange-bg">
                            <h4>Brouillons</h4>
                            <span class="stats-nb">{{ numberArticlesDrafts }}</span>
                        </div>
                    </a>
                    <a href="{{ path('user.profile_published_article') }}">
                        <div class="green-bg">
                            <h4>Publiés</h4>
                            <span class="stats-nb">{{ numberArticlesPublished }}</span>
                        </div>
                    </a>
                </div>
            {% endif %}

            <h3>Mes observations</h3>
            <div class="profile-observations text-center txt-white">
                {% if particulier %}
                    <div class="blue-bg awaiting-obs">
                        <h4>Observations en attente</h4>
                        <span class="stats-nb">{{ numberOfAwaitingObservations }}</span>
                    </div>
                {% endif %}
                <div class="{{ particulier ? 'green-bg' : 'blue-bg' }}">
                    <h4>Observations {% if particulier %}validées{% endif %}</h4>
                    <span class="stats-nb">{{ observations|length }}</span>
                </div>
            </div>
        </div>

        <div class="profile-obs-list">
        {# Observation published by user #}
        {% if observations|length > 0 %}
            <div class="profile-input-container text-center">
                <input type="text" placeholder="Rechercher une de mes observations">
            </div>
            {% for obs in observations %}
                <div class="personal-obs text-center">
                    <div class="personal-obs-img">
                        <img src="{{ asset(obs.image.webPath) | imagine_filter('profile_personal_obs_image') }}" alt="Photo de {{ obs.species.name }}">
                    </div>
                    <div class="personal-obs-date">
                        {{ obs.observedAt|date('d/m/Y') }}
                    </div>
                    <div class="personal-obs-name">
                        {{ obs.species.name }}
                    </div>
                    <div class="personal-obs-status">
                        {{ obs.validated }}
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="text-center">Vous n'avez pas encore ajouté d'observation.
                <a class="txt-orange" href="{{ url('observation.add') }}">En ajouter une maintenant.</a>
            </p>
        {% endif %}
        </div>
    </div>
{% endblock %}